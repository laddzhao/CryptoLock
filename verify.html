<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="æœ¬åœ°æ–‡ä»¶SHA-256æ ¡éªŒå·¥å…·ï¼Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¸ä¸Šä¼ ä»»ä½•æ•°æ®">
  <title>æ–‡ä»¶æ ¡éªŒï¼ˆSHAâ€‘256ï¼‰ â€” æœ¬åœ°æ ¡éªŒå™¨</title>
  <style>
    :root {
      --bg: #f6f8fb; --card: #fff; --accent: #0ea5e9; --accent-hover: #0284c7;
      --ok: #16a34a; --bad: #dc2626; --warning: #f59e0b; --muted: #6b7280;
      --border: #e6eef8; --text: #0f172a; --radius: 10px; --shadow: 0 8px 30px rgba(2, 6, 23, 0.06);
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --accent-hover: #0ea5e9;
        --ok: #22c55e; --bad: #ef4444; --warning: #f59e0b; --muted: #94a3b8;
        --border: #334155; --text: #f1f5f9;
      }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg); color: var(--text); line-height: 1.6;
      min-height: 100vh; padding: 18px;
    }
    .wrap {
      max-width: 900px; margin: 0 auto; background: var(--card);
      padding: 24px; border-radius: var(--radius); box-shadow: var(--shadow);
    }
    h1 { font-size: 1.5rem; margin-bottom: 8px; }
    h2 { font-size: 1.25rem; margin: 20px 0 12px; }
    .subtitle { font-size: 0.95rem; color: var(--muted); margin-bottom: 24px; }
    .panel {
      background: var(--bg); padding: 20px; border-radius: 8px;
      margin-top: 20px; border: 1px solid var(--border);
    }
    label {
      display: block; margin: 16px 0 8px; font-weight: 600;
      font-size: 0.95rem; color: var(--text);
    }
    input[type="file"], input[type="text"] {
      width: 100%; padding: 12px; border-radius: 6px; border: 2px solid var(--border);
      background: var(--card); color: var(--text); font-family: inherit; font-size: 0.95rem;
    }
    input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1); }
    .row { display: flex; gap: 12px; align-items: center; margin-top: 16px; flex-wrap: wrap; }
    button {
      background: var(--accent); color: white; border: none; padding: 12px 20px;
      border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.95rem;
      display: inline-flex; align-items: center; gap: 6px; min-height: 44px;
    }
    button:hover { background: var(--accent-hover); }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    button.secondary { background: transparent; color: var(--accent); border: 2px solid var(--border); }
    button.secondary:hover { background: rgba(14, 165, 233, 0.1); border-color: var(--accent); }
    .result {
      margin-top: 16px; padding: 16px; border-radius: 6px; font-weight: 600;
      font-size: 0.95rem; display: none; border-left: 4px solid transparent;
    }
    .result.success { background: rgba(22, 163, 74, 0.1); border-left-color: var(--ok); color: var(--ok); }
    .result.warning { background: rgba(245, 158, 11, 0.1); border-left-color: var(--warning); color: var(--warning); }
    .result.error { background: rgba(220, 38, 38, 0.1); border-left-color: var(--bad); color: var(--bad); }
    .result.info { background: rgba(14, 165, 233, 0.1); border-left-color: var(--accent); color: var(--accent); }
    .hash-display { margin-top: 16px; }
    .hash-label { font-size: 0.9rem; color: var(--muted); margin-bottom: 6px; }
    .hash-box {
      word-break: break-all; background: var(--card); padding: 12px; border-radius: 6px;
      border: 2px solid var(--border); font-family: monospace; font-size: 0.9rem; color: var(--text);
    }
    .hash-box.calculated { border-color: var(--accent); background: rgba(14, 165, 233, 0.05); }
    .stats { display: flex; gap: 20px; margin-top: 8px; font-size: 0.85rem; color: var(--muted); }
    ol, ul { padding-left: 20px; margin: 12px 0; }
    li { margin-bottom: 8px; }
    code {
      background: var(--bg); padding: 2px 6px; border-radius: 4px;
      font-family: monospace; font-size: 0.9rem; border: 1px solid var(--border);
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .file-info { display: flex; align-items: center; gap: 12px; margin-top: 8px; font-size: 0.9rem; color: var(--muted); }
    @media (max-width: 768px) {
      .wrap { padding: 16px; }
      .row { flex-direction: column; align-items: stretch; }
      button { width: 100%; justify-content: center; }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <h1>ğŸ“ æ–‡ä»¶æ ¡éªŒï¼ˆSHAâ€‘256ï¼‰</h1>
      <p class="subtitle">åœ¨æœ¬åœ°è®¡ç®—æ–‡ä»¶å“ˆå¸Œå¹¶ä¸å‘é€æ–¹æä¾›çš„å“ˆå¸Œæ¯”å¯¹ã€‚å…¨éƒ¨åœ¨æµè§ˆå™¨æœ¬åœ°æ‰§è¡Œï¼Œä¸ä¼šä¸Šä¼ ä»»ä½•æ–‡ä»¶æˆ–æ•°æ®ã€‚</p>
    </header>

    <section class="panel">
      <h2>å‘é€æ–¹ï¼ˆç®€è¦æ­¥éª¤ï¼‰</h2>
      <ol>
        <li>æŠŠæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼ˆä¾‹å¦‚ index.htmlï¼‰ã€‚</li>
        <li>åœ¨æœ¬æœºè®¡ç®— SHAâ€‘256ï¼š
          <ul>
            <li><strong>macOS/Linux:</strong> <code>shasum -a 256 æ–‡ä»¶å</code></li>
            <li><strong>Windows PowerShell:</strong> <code>Get-FileHash æ–‡ä»¶å -Algorithm SHA256</code></li>
            <li><strong>Windows CMD:</strong> <code>certutil -hashfile æ–‡ä»¶å SHA256</code></li>
          </ul>
        </li>
        <li>é€šè¿‡å¦ä¸€æ¡æ¸ é“ï¼ˆç”µè¯/çŸ­ä¿¡/å¦ä¸€æ¬¾èŠå¤©ï¼‰æŠŠå“ˆå¸Œå­—ç¬¦ä¸²å‘ç»™æ¥æ”¶æ–¹ã€‚</li>
      </ol>
    </section>

    <section class="panel">
      <h2>æ¥æ”¶æ–¹æ“ä½œ â€” æœ¬åœ°æ ¡éªŒ</h2>
      
      <div class="file-selection">
        <label for="fileInput">1) é€‰æ‹©è¦æ ¡éªŒçš„æœ¬åœ°æ–‡ä»¶</label>
        <input id="fileInput" type="file" accept="*/*">
        <div id="fileInfo" class="file-info" style="display: none;">
          ğŸ“„ <span id="fileName"></span> â€¢ <span id="fileSize"></span> â€¢ <span id="fileType"></span>
        </div>
      </div>

      <label for="expectedHash">2) ç²˜è´´å‘é€æ–¹ç»™ä½ çš„ SHAâ€‘256 å­—ç¬¦ä¸²</label>
      <input id="expectedHash" type="text" 
             placeholder="ä¾‹å¦‚ï¼š8d1c7d86c72b6cd4fc0e55c66cda1e9d6e40f319981d3cf9f96c23436e307c9f"
             autocomplete="off" spellcheck="false">

      <div class="row">
        <button id="calcBtn">âœ… è®¡ç®—å¹¶æ¯”å¯¹ SHAâ€‘256</button>
        <button id="pasteExpected" class="secondary">ğŸ“‹ ç²˜è´´å“ˆå¸Œå€¼</button>
        <button id="clearBtn" class="secondary">ğŸ—‘ï¸ æ¸…ç©º</button>
        <a href="index.html" class="back-link">â†©ï¸ è¿”å›åŠ å¯†é¡µé¢</a>
      </div>

      <div id="result" class="result" style="display: none;"></div>

      <div class="hash-display">
        <div class="hash-label">è®¡ç®—å‡ºçš„å“ˆå¸Œï¼ˆHEXï¼Œå¤§å†™ï¼‰ï¼š</div>
        <div id="computedHash" class="hash-box">å°šæœªè®¡ç®—</div>
        <div class="stats">
          <span id="hashLength">é•¿åº¦: 0</span>
          <span id="calcTime">è€—æ—¶: 0ms</span>
          <span id="fileSizeDisplay">æ–‡ä»¶: 0 B</span>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>è‹¥æ ¡éªŒå¤±è´¥æ€ä¹ˆåŠ</h2>
      <ol>
        <li><strong>ä¸è¦æ‰“å¼€è¯¥æ–‡ä»¶æˆ–è¾“å…¥å£ä»¤ã€‚</strong> æ–‡ä»¶å¯èƒ½å·²è¢«ç¯¡æ”¹ã€‚</li>
        <li>é€šè¿‡ç”µè¯ç¡®è®¤å‘é€æ–¹çš„å“ˆå¸Œæ˜¯å¦æ­£ç¡®ï¼›å¿…è¦æ—¶é‡ä¼ æ–‡ä»¶å¹¶ä½¿ç”¨ä¸åŒæ¸ é“å‘é€æ ¡éªŒå€¼ã€‚</li>
        <li>è‹¥æ–‡ä»¶æ¥è‡ªç½‘ç»œä¸”æ ¡éªŒå¤±è´¥ï¼Œè¯·å‹¿ä½¿ç”¨ï¼Œè”ç³»å‘å¸ƒè€…æ ¸å®å¹¶æ£€æŸ¥å‘å¸ƒæ¸ é“å®‰å…¨ï¼ˆ2FAã€æäº¤è®°å½•ï¼‰ã€‚</li>
        <li>ç¡®ä¿æ¯”è¾ƒçš„å“ˆå¸Œå€¼æ ¼å¼ä¸€è‡´ï¼ˆå»é™¤ç©ºæ ¼ã€ç»Ÿä¸€å¤§å°å†™ï¼‰ã€‚</li>
      </ol>
    </section>

    <section class="panel">
      <h2>å®‰å…¨æé†’</h2>
      <ul>
        <li>ğŸ”’ æ‰€æœ‰è®¡ç®—éƒ½åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­è¿›è¡Œï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨</li>
        <li>ğŸ“± å»ºè®®åœ¨å¯ä¿¡è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å·¥å…·</li>
        <li>ğŸ”‘ å§‹ç»ˆé€šè¿‡ä¸åŒæ¸ é“ä¼ è¾“å“ˆå¸Œå€¼å’Œæ–‡ä»¶æœ¬èº«</li>
        <li>ğŸ”„ å®šæœŸæ›´æ–°æ‚¨ä½¿ç”¨çš„åŠ å¯†å·¥å…·å’Œåº“</li>
        <li>ğŸ’¾ å¯¹äºé‡è¦æ–‡ä»¶ï¼Œå»ºè®®åŒæ—¶è®¡ç®—å¤šç§å“ˆå¸Œç®—æ³•ï¼ˆSHA-256ã€SHA-512ã€BLAKE2ï¼‰</li>
      </ul>
    </section>
  </main>

  <script>
    const fileInput = document.getElementById('fileInput');
    const expectedInput = document.getElementById('expectedHash');
    const calcBtn = document.getElementById('calcBtn');
    const pasteExpectedBtn = document.getElementById('pasteExpected');
    const clearBtn = document.getElementById('clearBtn');
    const resultEl = document.getElementById('result');
    const computedHashEl = document.getElementById('computedHash');
    const hashLengthEl = document.getElementById('hashLength');
    const calcTimeEl = document.getElementById('calcTime');
    const fileSizeDisplayEl = document.getElementById('fileSizeDisplay');
    const fileInfoEl = document.getElementById('fileInfo');
    const fileNameEl = document.getElementById('fileName');
    const fileSizeEl = document.getElementById('fileSize');
    const fileTypeEl = document.getElementById('fileType');

    function formatBytes(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024, sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function formatTime(ms) {
      return ms < 1000 ? `${ms}ms` : `${(ms / 1000).toFixed(2)}s`;
    }

    function normalizeHash(hash) {
      return hash.replace(/\s+/g, '').toUpperCase().trim();
    }

    function bufToHex(buffer) {
      return Array.from(new Uint8Array(buffer))
        .map(b => b.toString(16).padStart(2, '0'))
        .join('').toUpperCase();
    }

    async function computeFileSHA256(file) {
      const startTime = performance.now();
      const arrayBuffer = await file.arrayBuffer();
      const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
      const endTime = performance.now();
      
      return {
        hash: bufToHex(hashBuffer),
        time: endTime - startTime
      };
    }

    function showResult(type, message) {
      resultEl.className = `result ${type}`;
      resultEl.textContent = message;
      resultEl.style.display = 'block';
      resultEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    fileInput.addEventListener('change', function() {
      if (this.files.length > 0) {
        const file = this.files[0];
        fileNameEl.textContent = file.name;
        fileSizeEl.textContent = formatBytes(file.size);
        fileTypeEl.textContent = file.type || 'æœªçŸ¥ç±»å‹';
        fileSizeDisplayEl.textContent = `æ–‡ä»¶: ${formatBytes(file.size)}`;
        fileInfoEl.style.display = 'flex';
        computedHashEl.textContent = 'è¯·é‡æ–°è®¡ç®—';
        computedHashEl.className = 'hash-box';
        showResult('info', 'å·²é€‰æ‹©æ–°æ–‡ä»¶ï¼Œè¯·ç‚¹å‡»è®¡ç®—æŒ‰é’®');
      } else {
        fileInfoEl.style.display = 'none';
      }
    });

    calcBtn.addEventListener('click', async () => {
      const file = fileInput.files[0];
      if (!file) {
        showResult('error', 'è¯·å…ˆé€‰æ‹©è¦æ ¡éªŒçš„æ–‡ä»¶');
        return;
      }

      try {
        calcBtn.disabled = true;
        calcBtn.textContent = 'è®¡ç®—ä¸­...';
        
        const { hash, time } = await computeFileSHA256(file);
        
        computedHashEl.textContent = hash;
        computedHashEl.className = 'hash-box calculated';
        hashLengthEl.textContent = `é•¿åº¦: ${hash.length}`;
        calcTimeEl.textContent = `è€—æ—¶: ${formatTime(time)}`;
        
        const expected = normalizeHash(expectedInput.value);
        if (!expected) {
          showResult('warning', 'å·²è®¡ç®—å‡ºæ–‡ä»¶å“ˆå¸Œï¼Œè¯·ç²˜è´´å‘é€æ–¹æä¾›çš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”å¯¹');
          return;
        }
        
        showResult(hash === expected ? 'success' : 'error',
          hash === expected ? 'âœ… æ ¡éªŒé€šè¿‡ï¼šå“ˆå¸Œä¸€è‡´ï¼Œæ–‡ä»¶å®Œæ•´å¯ä¿¡' 
          : 'âŒ æ ¡éªŒå¤±è´¥ï¼šå“ˆå¸Œä¸ä¸€è‡´ï¼æ–‡ä»¶å¯èƒ½å·²è¢«ç¯¡æ”¹');
      } catch (error) {
        showResult('error', `è®¡ç®—å¤±è´¥ï¼š${error.message || 'æœªçŸ¥é”™è¯¯'}`);
        computedHashEl.textContent = 'è®¡ç®—é”™è¯¯';
        computedHashEl.className = 'hash-box';
      } finally {
        calcBtn.disabled = false;
        calcBtn.textContent = 'âœ… è®¡ç®—å¹¶æ¯”å¯¹ SHAâ€‘256';
      }
    });

    pasteExpectedBtn.addEventListener('click', async () => {
      try {
        const text = await navigator.clipboard.readText();
        if (text) {
          expectedInput.value = text.trim();
          showResult('info', 'å·²ä»å‰ªè´´æ¿ç²˜è´´å“ˆå¸Œå€¼');
        }
      } catch {
        showResult('error', 'æ— æ³•è¯»å–å‰ªè´´æ¿');
      }
    });

    clearBtn.addEventListener('click', () => {
      fileInput.value = '';
      expectedInput.value = '';
      computedHashEl.textContent = 'å°šæœªè®¡ç®—';
      computedHashEl.className = 'hash-box';
      resultEl.style.display = 'none';
      fileInfoEl.style.display = 'none';
      hashLengthEl.textContent = 'é•¿åº¦: 0';
      calcTimeEl.textContent = 'è€—æ—¶: 0ms';
      fileSizeDisplayEl.textContent = 'æ–‡ä»¶: 0 B';
    });

    expectedInput.addEventListener('input', function() {
      this.value = this.value.toUpperCase().replace(/[^A-F0-9]/gi, '');
    });

    console.log('æ–‡ä»¶æ ¡éªŒå·¥å…·å·²åŠ è½½');
  </script>
</body>
</html>
