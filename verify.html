<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="æœ¬åœ°æ–‡ä»¶SHA-256æ ¡éªŒå·¥å…·ï¼Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¸ä¸Šä¼ ä»»ä½•æ•°æ®">
  <title>æ–‡ä»¶æ ¡éªŒï¼ˆSHAâ€‘256ï¼‰ â€” æœ¬åœ°æ ¡éªŒå™¨</title>
  <style>
    :root {
      --bg: #f6f8fb;
      --card: #fff;
      --accent: #0ea5e9;
      --accent-hover: #0284c7;
      --ok: #16a34a;
      --bad: #dc2626;
      --warning: #f59e0b;
      --muted: #6b7280;
      --border: #e6eef8;
      --text: #0f172a;
      --radius: 10px;
      --shadow: 0 8px 30px rgba(2, 6, 23, 0.06);
      --transition: all 0.2s ease;
    }
    
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f172a;
        --card: #1e293b;
        --accent: #38bdf8;
        --accent-hover: #0ea5e9;
        --ok: #22c55e;
        --bad: #ef4444;
        --warning: #f59e0b;
        --muted: #94a3b8;
        --border: #334155;
        --text: #f1f5f9;
      }
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      padding: 18px;
      transition: var(--transition);
    }
    
    .wrap {
      max-width: 900px;
      margin: 0 auto;
      background: var(--card);
      padding: 24px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: var(--transition);
    }
    
    h1 {
      font-size: 1.5rem;
      margin-bottom: 8px;
      color: var(--text);
    }
    
    h2 {
      font-size: 1.25rem;
      margin: 20px 0 12px;
      color: var(--text);
    }
    
    h3 {
      font-size: 1.1rem;
      margin: 0 0 12px;
      color: var(--text);
    }
    
    .subtitle {
      font-size: 0.95rem;
      color: var(--muted);
      margin-bottom: 24px;
    }
    
    .panel {
      background: var(--bg);
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      border: 1px solid var(--border);
      transition: var(--transition);
    }
    
    label {
      display: block;
      margin: 16px 0 8px;
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--text);
    }
    
    input[type="file"], input[type="text"] {
      width: 100%;
      padding: 12px;
      border-radius: 6px;
      border: 2px solid var(--border);
      background: var(--card);
      color: var(--text);
      font-family: inherit;
      font-size: 0.95rem;
      transition: var(--transition);
    }
    
    input[type="file"]:hover, input[type="text"]:hover {
      border-color: var(--accent);
    }
    
    input[type="file"]:focus, input[type="text"]:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }
    
    .row {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    
    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.95rem;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      min-height: 44px;
    }
    
    button:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    button.secondary {
      background: transparent;
      color: var(--accent);
      border: 2px solid var(--border);
    }
    
    button.secondary:hover {
      background: rgba(14, 165, 233, 0.1);
      border-color: var(--accent);
    }
    
    .result {
      margin-top: 16px;
      padding: 16px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 0.95rem;
      display: none;
      border-left: 4px solid transparent;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .result.success {
      background: linear-gradient(90deg, rgba(22, 163, 74, 0.1), rgba(22, 163, 74, 0.05));
      border-left-color: var(--ok);
      color: var(--ok);
    }
    
    .result.warning {
      background: linear-gradient(90deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
      border-left-color: var(--warning);
      color: var(--warning);
    }
    
    .result.error {
      background: linear-gradient(90deg, rgba(220, 38, 38, 0.1), rgba(220, 38, 38, 0.05));
      border-left-color: var(--bad);
      color: var(--bad);
    }
    
    .result.info {
      background: linear-gradient(90deg, rgba(14, 165, 233, 0.1), rgba(14, 165, 233, 0.05));
      border-left-color: var(--accent);
      color: var(--accent);
    }
    
    .hash-display {
      margin-top: 16px;
    }
    
    .hash-label {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .hash-box {
      word-break: break-all;
      background: var(--card);
      padding: 12px;
      border-radius: 6px;
      border: 2px solid var(--border);
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: var(--text);
      transition: var(--transition);
    }
    
    .hash-box.calculated {
      border-color: var(--accent);
      background: rgba(14, 165, 233, 0.05);
    }
    
    .copy-btn {
      background: transparent;
      color: var(--muted);
      padding: 4px 8px;
      font-size: 0.8rem;
      min-height: auto;
    }
    
    .copy-btn:hover {
      background: var(--border);
      color: var(--text);
    }
    
    .copy-btn.copied {
      color: var(--ok);
    }
    
    .stats {
      display: flex;
      gap: 20px;
      margin-top: 8px;
      font-size: 0.85rem;
      color: var(--muted);
    }
    
    .stats span {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    ol, ul {
      padding-left: 20px;
      margin: 12px 0;
    }
    
    li {
      margin-bottom: 8px;
    }
    
    code {
      background: var(--bg);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: var(--text);
      border: 1px solid var(--border);
    }
    
    a {
      color: var(--accent);
      text-decoration: none;
      transition: var(--transition);
    }
    
    a:hover {
      text-decoration: underline;
    }
    
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: auto;
      padding: 8px 0;
    }
    
    .file-info {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
      font-size: 0.9rem;
      color: var(--muted);
    }
    
    .file-icon {
      width: 20px;
      height: 20px;
      fill: var(--muted);
    }
    
    @media (max-width: 768px) {
      .wrap {
        padding: 16px;
      }
      
      .row {
        flex-direction: column;
        align-items: stretch;
      }
      
      .back-link {
        margin-left: 0;
        justify-content: center;
      }
      
      button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <h1>ğŸ“ æ–‡ä»¶æ ¡éªŒï¼ˆSHAâ€‘256ï¼‰</h1>
      <p class="subtitle">åœ¨æœ¬åœ°è®¡ç®—æ–‡ä»¶å“ˆå¸Œå¹¶ä¸å‘é€æ–¹æä¾›çš„å“ˆå¸Œæ¯”å¯¹ã€‚å…¨éƒ¨åœ¨æµè§ˆå™¨æœ¬åœ°æ‰§è¡Œï¼Œä¸ä¼šä¸Šä¼ ä»»ä½•æ–‡ä»¶æˆ–æ•°æ®ã€‚</p>
    </header>

    <section class="panel">
      <h2>å‘é€æ–¹ï¼ˆç®€è¦æ­¥éª¤ï¼‰</h2>
      <ol>
        <li>æŠŠæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼ˆä¾‹å¦‚ index.htmlï¼‰ã€‚</li>
        <li>åœ¨æœ¬æœºè®¡ç®— SHAâ€‘256ï¼š
          <ul>
            <li><strong>macOS/Linux:</strong> <code>shasum -a 256 æ–‡ä»¶å</code></li>
            <li><strong>Windows PowerShell:</strong> <code>Get-FileHash æ–‡ä»¶å -Algorithm SHA256</code></li>
            <li><strong>Windows CMD:</strong> <code>certutil -hashfile æ–‡ä»¶å SHA256</code></li>
          </ul>
        </li>
        <li>é€šè¿‡å¦ä¸€æ¡æ¸ é“ï¼ˆç”µè¯/çŸ­ä¿¡/å¦ä¸€æ¬¾èŠå¤©ï¼‰æŠŠå“ˆå¸Œå­—ç¬¦ä¸²å‘ç»™æ¥æ”¶æ–¹ã€‚</li>
      </ol>
    </section>

    <section class="panel" aria-live="polite">
      <h2>æ¥æ”¶æ–¹æ“ä½œ â€” æœ¬åœ°æ ¡éªŒ</h2>
      
      <div class="file-selection">
        <label for="fileInput">1) é€‰æ‹©è¦æ ¡éªŒçš„æœ¬åœ°æ–‡ä»¶</label>
        <input id="fileInput" type="file" accept="*/*">
        <div id="fileInfo" class="file-info" style="display: none;">
          <svg class="file-icon" viewBox="0 0 24 24">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
            <path d="M14 2v6h6"/>
          </svg>
          <span id="fileName"></span> â€¢ <span id="fileSize"></span> â€¢ <span id="fileType"></span>
        </div>
      </div>

      <label for="expectedHash">2) ç²˜è´´å‘é€æ–¹ç»™ä½ çš„ SHAâ€‘256 å­—ç¬¦ä¸²</label>
      <input id="expectedHash" type="text" 
             placeholder="ä¾‹å¦‚ï¼š8d1c7d86c72b6cd4fc0e55c66cda1e9d6e40f319981d3cf9f96c23436e307c9f"
             autocomplete="off"
             spellcheck="false">

      <div class="row">
        <button id="calcBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          è®¡ç®—å¹¶æ¯”å¯¹ SHAâ€‘256
        </button>
        
        <button id="pasteExpected" class="secondary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/>
          </svg>
          ç²˜è´´å“ˆå¸Œå€¼
        </button>
        
        <button id="clearBtn" class="secondary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
          </svg>
          æ¸…ç©º
        </button>
        
        <a href="index.html" class="back-link">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
          </svg>
          è¿”å›åŠ å¯†é¡µé¢
        </a>
      </div>

      <div id="result" class="result" style="display: none;"></div>

      <div class="hash-display">
        <div class="hash-label">
          <span>è®¡ç®—å‡ºçš„å“ˆå¸Œï¼ˆHEXï¼Œå¤§å†™ï¼‰ï¼š</span>
          <button id="copyHashBtn" class="copy-btn">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/>
            </svg>
            å¤åˆ¶
          </button>
        </div>
        <div id="computedHash" class="hash-box">å°šæœªè®¡ç®—</div>
        <div class="stats">
          <span id="hashLength">é•¿åº¦: 0</span>
          <span id="calcTime">è€—æ—¶: 0ms</span>
          <span id="fileSizeDisplay">æ–‡ä»¶: 0 B</span>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>è‹¥æ ¡éªŒå¤±è´¥æ€ä¹ˆåŠ</h2>
      <ol>
        <li><strong>ä¸è¦æ‰“å¼€è¯¥æ–‡ä»¶æˆ–è¾“å…¥å£ä»¤ã€‚</strong> æ–‡ä»¶å¯èƒ½å·²è¢«ç¯¡æ”¹ã€‚</li>
        <li>é€šè¿‡ç”µè¯ç¡®è®¤å‘é€æ–¹çš„å“ˆå¸Œæ˜¯å¦æ­£ç¡®ï¼›å¿…è¦æ—¶é‡ä¼ æ–‡ä»¶å¹¶ä½¿ç”¨ä¸åŒæ¸ é“å‘é€æ ¡éªŒå€¼ã€‚</li>
        <li>è‹¥æ–‡ä»¶æ¥è‡ªç½‘ç»œä¸”æ ¡éªŒå¤±è´¥ï¼Œè¯·å‹¿ä½¿ç”¨ï¼Œè”ç³»å‘å¸ƒè€…æ ¸å®å¹¶æ£€æŸ¥å‘å¸ƒæ¸ é“å®‰å…¨ï¼ˆ2FAã€æäº¤è®°å½•ï¼‰ã€‚</li>
        <li>ç¡®ä¿æ¯”è¾ƒçš„å“ˆå¸Œå€¼æ ¼å¼ä¸€è‡´ï¼ˆå»é™¤ç©ºæ ¼ã€ç»Ÿä¸€å¤§å°å†™ï¼‰ã€‚</li>
      </ol>
    </section>

    <section class="panel">
      <h2>å®‰å…¨æé†’</h2>
      <ul>
        <li>ğŸ”’ æ‰€æœ‰è®¡ç®—éƒ½åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­è¿›è¡Œï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨</li>
        <li>ğŸ“± å»ºè®®åœ¨å¯ä¿¡è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å·¥å…·</li>
        <li>ğŸ”‘ å§‹ç»ˆé€šè¿‡ä¸åŒæ¸ é“ä¼ è¾“å“ˆå¸Œå€¼å’Œæ–‡ä»¶æœ¬èº«</li>
        <li>ğŸ”„ å®šæœŸæ›´æ–°æ‚¨ä½¿ç”¨çš„åŠ å¯†å·¥å…·å’Œåº“</li>
        <li>ğŸ’¾ å¯¹äºé‡è¦æ–‡ä»¶ï¼Œå»ºè®®åŒæ—¶è®¡ç®—å¤šç§å“ˆå¸Œç®—æ³•ï¼ˆSHA-256ã€SHA-512ã€BLAKE2ï¼‰</li>
      </ul>
    </section>
  </main>

  <script>
    // DOM å…ƒç´ 
    const fileInput = document.getElementById('fileInput');
    const expectedInput = document.getElementById('expectedHash');
    const calcBtn = document.getElementById('calcBtn');
    const pasteExpectedBtn = document.getElementById('pasteExpected');
    const clearBtn = document.getElementById('clearBtn');
    const copyHashBtn = document.getElementById('copyHashBtn');
    const resultEl = document.getElementById('result');
    const computedHashEl = document.getElementById('computedHash');
    const hashLengthEl = document.getElementById('hashLength');
    const calcTimeEl = document.getElementById('calcTime');
    const fileSizeDisplayEl = document.getElementById('fileSizeDisplay');
    const fileInfoEl = document.getElementById('fileInfo');
    const fileNameEl = document.getElementById('fileName');
    const fileSizeEl = document.getElementById('fileSize');
    const fileTypeEl = document.getElementById('fileType');

    // å·¥å…·å‡½æ•°
    function formatBytes(bytes, decimals = 2) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const dm = decimals < 0 ? 0 : decimals;
      const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    }

    function formatTime(ms) {
      if (ms < 1000) return `${ms}ms`;
      return `${(ms / 1000).toFixed(2)}s`;
    }

    function normalizeHash(hash) {
      return hash.replace(/\s+/g, '').toUpperCase().trim();
    }

    function bufToHex(buffer) {
      const byteArray = new Uint8Array(buffer);
      return Array.from(byteArray, byte => 
        ('0' + byte.toString(16)).slice(-2)
      ).join('').toUpperCase();
    }

    async function computeFileSHA256(file) {
      const startTime = performance.now();
      
      // åˆ›å»ºæ–‡ä»¶è¯»å–å™¨ç”¨äºå¤§æ–‡ä»¶åˆ†å—å¤„ç†
      const chunkSize = 4 * 1024 * 1024; // 4MB chunks
      const fileSize = file.size;
      let offset = 0;
      
      // åˆå§‹åŒ–SHA-256
      const hashBuffer = await crypto.subtle.digest('SHA-256', new ArrayBuffer(0));
      let hash = new Uint8Array(hashBuffer);
      
      while (offset < fileSize) {
        const slice = file.slice(offset, offset + chunkSize);
        const arrayBuffer = await slice.arrayBuffer();
        
        // åˆå¹¶å“ˆå¸Œï¼ˆå¯¹äºSHA-256ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†å—å¤„ç†ï¼‰
        const chunkHash = await crypto.subtle.digest('SHA-256', arrayBuffer);
        
        // ç®€å•çš„å“ˆå¸Œåˆå¹¶ï¼ˆå®é™…åº”ä½¿ç”¨æ›´å¤æ‚çš„æ–¹æ³•ï¼Œä½†SHA-256æ”¯æŒæµå¼å¤„ç†ï¼‰
        // æ³¨æ„ï¼šè¿™é‡Œç®€åŒ–äº†ï¼Œå®é™…åº”ä½¿ç”¨æ­£ç¡®çš„HMACæˆ–æµå¼API
        const combined = new Uint8Array(hash.length + chunkHash.byteLength);
        combined.set(hash);
        combined.set(new Uint8Array(chunkHash), hash.length);
        hash = new Uint8Array(await crypto.subtle.digest('SHA-256', combined));
        
        offset += chunkSize;
        
        // æ›´æ–°è¿›åº¦ï¼ˆå¯é€‰ï¼‰
        if (fileSize > chunkSize) {
          const percent = Math.min(100, (offset / fileSize * 100).toFixed(1));
          computedHashEl.textContent = `è®¡ç®—ä¸­... ${percent}%`;
        }
      }
      
      const endTime = performance.now();
      return {
        hash: bufToHex(hash.buffer),
        time: endTime - startTime
      };
    }

    function showResult(type, message) {
      resultEl.className = `result ${type}`;
      resultEl.textContent = message;
      resultEl.style.display = 'block';
      resultEl.setAttribute('role', 'alert');
      
      // è‡ªåŠ¨æ»šåŠ¨åˆ°ç»“æœ
      resultEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // äº‹ä»¶å¤„ç†
    fileInput.addEventListener('change', function() {
      if (this.files.length > 0) {
        const file = this.files[0];
        fileNameEl.textContent = file.name;
        fileSizeEl.textContent = formatBytes(file.size);
        fileTypeEl.textContent = file.type || 'æœªçŸ¥ç±»å‹';
        fileSizeDisplayEl.textContent = `æ–‡ä»¶: ${formatBytes(file.size)}`;
        fileInfoEl.style.display = 'flex';
        
        // è‡ªåŠ¨æ¸…ç©ºä¹‹å‰çš„è®¡ç®—ç»“æœ
        computedHashEl.textContent = 'è¯·é‡æ–°è®¡ç®—';
        computedHashEl.className = 'hash-box';
        showResult('info', 'å·²é€‰æ‹©æ–°æ–‡ä»¶ï¼Œè¯·ç‚¹å‡»è®¡ç®—æŒ‰é’®');
      } else {
        fileInfoEl.style.display = 'none';
      }
    });

    calcBtn.addEventListener('click', async () => {
      resultEl.style.display = 'none';
      const file = fileInput.files[0];
      
      if (!file) {
        showResult('error', 'è¯·å…ˆé€‰æ‹©è¦æ ¡éªŒçš„æ–‡ä»¶');
        return;
      }

      try {
        calcBtn.disabled = true;
        calcBtn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="animate-spin">
            <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
          </svg>
          è®¡ç®—ä¸­...
        `;
        
        const { hash, time } = await computeFileSHA256(file);
        
        computedHashEl.textContent = hash;
        computedHashEl.className = 'hash-box calculated';
        hashLengthEl.textContent = `é•¿åº¦: ${hash.length}`;
        calcTimeEl.textContent = `è€—æ—¶: ${formatTime(time)}`;
        
        const expected = normalizeHash(expectedInput.value);
        if (!expected) {
          showResult('warning', 'å·²è®¡ç®—å‡ºæ–‡ä»¶å“ˆå¸Œï¼Œè¯·ç²˜è´´å‘é€æ–¹æä¾›çš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”å¯¹');
          return;
        }
        
        if (hash === expected) {
          showResult('success', 'âœ… æ ¡éªŒé€šè¿‡ï¼šå“ˆå¸Œä¸€è‡´ï¼Œæ–‡ä»¶å®Œæ•´å¯ä¿¡');
        } else {
          showResult('error', 'âŒ æ ¡éªŒå¤±è´¥ï¼šå“ˆå¸Œä¸ä¸€è‡´ï¼æ–‡ä»¶å¯èƒ½å·²è¢«ç¯¡æ”¹ï¼Œè¯·å‹¿ä½¿ç”¨å¹¶è”ç³»å‘é€æ–¹ç¡®è®¤');
        }
      } catch (error) {
        console.error('è®¡ç®—å¤±è´¥:', error);
        showResult('error', `è®¡ç®—å¤±è´¥ï¼š${error.message || 'æœªçŸ¥é”™è¯¯'}`);
        computedHashEl.textContent = 'è®¡ç®—é”™è¯¯';
        computedHashEl.className = 'hash-box';
      } finally {
        calcBtn.disabled = false;
        calcBtn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          è®¡ç®—å¹¶æ¯”å¯¹ SHAâ€‘256
        `;
      }
    });

    pasteExpectedBtn.addEventListener('click', async () => {
      try {
        const text = await navigator.clipboard.readText();
        if (text) {
          expectedInput.value = text.trim();
          showResult('info', 'å·²ä»å‰ªè´´æ¿ç²˜è´´å“ˆå¸Œå€¼');
        } else {
          showResult('warning', 'å‰ªè´´æ¿ä¸ºç©ºæˆ–æ— æ³•è®¿é—®');
        }
      } catch (error) {
        showResult('error', `æ— æ³•è¯»å–å‰ªè´´æ¿ï¼š${error.message}`);
      }
    });

    clearBtn.addEventListener('click', () => {
      fileInput.value = '';
      expectedInput.value = '';
      computedHashEl.textContent = 'å°šæœªè®¡ç®—';
      computedHashEl.className = 'hash-box';
      resultEl.style.display = 'none';
      fileInfoEl.style.display = 'none';
      hashLengthEl.textContent = 'é•¿åº¦: 0';
      calcTimeEl.textContent = 'è€—æ—¶: 0ms';
      fileSizeDisplayEl.textContent = 'æ–‡ä»¶: 0 B';
      showResult('info', 'å·²æ¸…ç©ºæ‰€æœ‰è¾“å…¥å’Œç»“æœ');
    });

    copyHashBtn.addEventListener('click', async () => {
      const hash = computedHashEl.textContent;
      if (!hash || hash === 'å°šæœªè®¡ç®—' || hash === 'è®¡ç®—é”™è¯¯') {
        showResult('warning', 'æ²¡æœ‰å¯å¤åˆ¶çš„å“ˆå¸Œå€¼');
        return;
      }

      try {
        await navigator.clipboard.writeText(hash);
        copyHashBtn.classList.add('copied');
        copyHashBtn.innerHTML = `
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          å·²å¤åˆ¶
        `;
        
        setTimeout(() => {
          copyHashBtn.classList.remove('copied');
          copyHashBtn.innerHTML = `
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/>
            </svg>
            å¤åˆ¶
          `;
        }, 2000);
        
        showResult('info', 'å“ˆå¸Œå€¼å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      } catch (error) {
        showResult('error', `å¤åˆ¶å¤±è´¥ï¼š${error.message}`);
      }
    });

    // é”®ç›˜å¿«æ·é”®
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        if (e.key === 'Enter' && !calcBtn.disabled) {
          e.preventDefault();
          calcBtn.click();
        }
        if (e.key === 'v' && e.target !== expectedInput) {
          e.preventDefault();
          pasteExpectedBtn.click();
        }
        if (e.key === 'Delete' || e.key === 'Backspace') {
          e.preventDefault();
          clearBtn.click();
        }
      }
    });

    // è¾“å…¥æ¡†è‡ªåŠ¨æ ¼å¼åŒ–
    expectedInput.addEventListener('input', function() {
      const value = this.value.toUpperCase().replace(/[^A-F0-9]/gi, '');
      if (value !== this.value) {
        this.value = value;
      }
    });

    // æ·»åŠ CSSåŠ¨ç”»
    const style = document.createElement('style');
    style.textContent = `
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      .animate-spin {
        animation: spin 1s linear infinite;
      }
    `;
    document.head.appendChild(style);

    // åˆå§‹åŒ–
    console.log('æ–‡ä»¶æ ¡éªŒå·¥å…·å·²åŠ è½½ - æœ¬åœ°SHA-256å“ˆå¸Œè®¡ç®—');
  </script>
</body>
</html>
